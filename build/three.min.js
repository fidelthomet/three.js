!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.THREE={})}(this,function(t){"use strict";function p(t,i){this.x=t||0,this.y=i||0}var s,e;void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),s=1;s<arguments.length;s++){var e=arguments[s];if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i}),Object.defineProperties(p.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(p.prototype,{isVector2:!0,set:function(t,i){return this.x=t,this.y=i,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var i=this.x,s=this.y,e=t.elements;return this.x=e[0]*i+e[3]*s+e[6],this.y=e[1]*i+e[4]*s+e[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},clampScalar:(s=new p,e=new p,function(t,i){return s.set(t,t),e.set(i,i),this.clamp(s,e)}),clampLength:function(t,i){var s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(i,s)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y;return i*i+s*s},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t},fromBufferAttribute:function(t,i,s){return void 0!==s&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this},rotateAround:function(t,i){var s=Math.cos(i),e=Math.sin(i),n=this.x-t.x,r=this.y-t.y;return this.x=n*s-r*e+t.x,this.y=n*e+r*s+t.y,this}});var c,l,n,r,o,h,i,a,u,y,f,v,m,x,d,g,z,M,_,w={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var n=[],t=0;t<256;t++)n[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(n[255&t]+n[t>>8&255]+n[t>>16&255]+n[t>>24&255]+"-"+n[255&i]+n[i>>8&255]+"-"+n[i>>16&15|64]+n[i>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]).toUpperCase()}}(),clamp:function(t,i,s){return Math.max(i,Math.min(s,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,s,e,n){return e+(t-i)*(n-e)/(s-i)},lerp:function(t,i,s){return(1-s)*t+s*i},smoothstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*(3-2*t)},smootherstep:function(t,i,s){return t<=i?0:s<=t?1:(t=(t-i)/(s-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*w.DEG2RAD},radToDeg:function(t){return t*w.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function C(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function b(t,i,s,e){this._x=t||0,this._y=i||0,this._z=s||0,this._w=void 0!==e?e:1}function S(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0}function A(){this.type="Curve",this.arcLengthDivisions=200}function O(t,i,s,e,n,r,o,h){A.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=i||0,this.xRadius=s||1,this.yRadius=e||1,this.aStartAngle=n||0,this.aEndAngle=r||2*Math.PI,this.aClockwise=o||!1,this.aRotation=h||0}function E(t,i,s,e,n,r){O.call(this,t,i,s,s,e,n,r),this.type="ArcCurve"}function R(){var n=0,r=0,o=0,h=0;function u(t,i,s,e){o=-3*(n=t)+3*i-2*(r=s)-e,h=2*t-2*i+s+e}return{initCatmullRom:function(t,i,s,e,n){u(i,s,n*(s-t),n*(e-i))},initNonuniformCatmullRom:function(t,i,s,e,n,r,o){var h=(i-t)/n-(s-t)/(n+r)+(s-i)/r,a=(s-i)/r-(e-i)/(r+o)+(e-s)/o;u(i,s,h*=r,a*=r)},calc:function(t){var i=t*t;return n+r*t+o*i+h*(i*t)}}}Object.assign(C.prototype,{isMatrix4:!0,set:function(t,i,s,e,n,r,o,h,a,u,c,l,y,p,f,v){var m=this.elements;return m[0]=t,m[4]=i,m[8]=s,m[12]=e,m[1]=n,m[5]=r,m[9]=o,m[13]=h,m[2]=a,m[6]=u,m[10]=c,m[14]=l,m[3]=y,m[7]=p,m[11]=f,m[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new C).fromArray(this.elements)},copy:function(t){var i=this.elements,s=t.elements;return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],this},copyPosition:function(t){var i=this.elements,s=t.elements;return i[12]=s[12],i[13]=s[13],i[14]=s[14],this},extractBasis:function(t,i,s){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,s){return this.set(t.x,i.x,s.x,0,t.y,i.y,s.y,0,t.z,i.z,s.z,0,0,0,0,1),this},extractRotation:(u=new S,function(t){var i=this.elements,s=t.elements,e=1/u.setFromMatrixColumn(t,0).length(),n=1/u.setFromMatrixColumn(t,1).length(),r=1/u.setFromMatrixColumn(t,2).length();return i[0]=s[0]*e,i[1]=s[1]*e,i[2]=s[2]*e,i[3]=0,i[4]=s[4]*n,i[5]=s[5]*n,i[6]=s[6]*n,i[7]=0,i[8]=s[8]*r,i[9]=s[9]*r,i[10]=s[10]*r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=this.elements,s=t.x,e=t.y,n=t.z,r=Math.cos(s),o=Math.sin(s),h=Math.cos(e),a=Math.sin(e),u=Math.cos(n),c=Math.sin(n);if("XYZ"===t.order){var l=r*u,y=r*c,p=o*u,f=o*c;i[0]=h*u,i[4]=-h*c,i[8]=a,i[1]=y+p*a,i[5]=l-f*a,i[9]=-o*h,i[2]=f-l*a,i[6]=p+y*a,i[10]=r*h}else if("YXZ"===t.order){var v=h*u,m=h*c,x=a*u,d=a*c;i[0]=v+d*o,i[4]=x*o-m,i[8]=r*a,i[1]=r*c,i[5]=r*u,i[9]=-o,i[2]=m*o-x,i[6]=d+v*o,i[10]=r*h}else if("ZXY"===t.order){v=h*u,m=h*c,x=a*u,d=a*c;i[0]=v-d*o,i[4]=-r*c,i[8]=x+m*o,i[1]=m+x*o,i[5]=r*u,i[9]=d-v*o,i[2]=-r*a,i[6]=o,i[10]=r*h}else if("ZYX"===t.order){l=r*u,y=r*c,p=o*u,f=o*c;i[0]=h*u,i[4]=p*a-y,i[8]=l*a+f,i[1]=h*c,i[5]=f*a+l,i[9]=y*a-p,i[2]=-a,i[6]=o*h,i[10]=r*h}else if("YZX"===t.order){var g=r*h,z=r*a,M=o*h,_=o*a;i[0]=h*u,i[4]=_-g*c,i[8]=M*c+z,i[1]=c,i[5]=r*u,i[9]=-o*u,i[2]=-a*u,i[6]=z*c+M,i[10]=g-_*c}else if("XZY"===t.order){g=r*h,z=r*a,M=o*h,_=o*a;i[0]=h*u,i[4]=-c,i[8]=a*u,i[1]=g*c+_,i[5]=r*u,i[9]=z*c-M,i[2]=M*c-z,i[6]=o*u,i[10]=_*c+g}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:(i=new S(0,0,0),a=new S(1,1,1),function(t){return this.compose(i,t,a)}),lookAt:(r=new S,o=new S,h=new S,function(t,i,s){var e=this.elements;return h.subVectors(t,i),0===h.lengthSq()&&(h.z=1),h.normalize(),r.crossVectors(s,h),0===r.lengthSq()&&(1===Math.abs(s.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),r.crossVectors(s,h)),r.normalize(),o.crossVectors(h,r),e[0]=r.x,e[4]=o.x,e[8]=h.x,e[1]=r.y,e[5]=o.y,e[9]=h.y,e[2]=r.z,e[6]=o.z,e[10]=h.z,this}),multiply:function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var s=t.elements,e=i.elements,n=this.elements,r=s[0],o=s[4],h=s[8],a=s[12],u=s[1],c=s[5],l=s[9],y=s[13],p=s[2],f=s[6],v=s[10],m=s[14],x=s[3],d=s[7],g=s[11],z=s[15],M=e[0],_=e[4],w=e[8],C=e[12],b=e[1],S=e[5],A=e[9],O=e[13],E=e[2],R=e[6],N=e[10],P=e[14],T=e[3],L=e[7],V=e[11],k=e[15];return n[0]=r*M+o*b+h*E+a*T,n[4]=r*_+o*S+h*R+a*L,n[8]=r*w+o*A+h*N+a*V,n[12]=r*C+o*O+h*P+a*k,n[1]=u*M+c*b+l*E+y*T,n[5]=u*_+c*S+l*R+y*L,n[9]=u*w+c*A+l*N+y*V,n[13]=u*C+c*O+l*P+y*k,n[2]=p*M+f*b+v*E+m*T,n[6]=p*_+f*S+v*R+m*L,n[10]=p*w+f*A+v*N+m*V,n[14]=p*C+f*O+v*P+m*k,n[3]=x*M+d*b+g*E+z*T,n[7]=x*_+d*S+g*R+z*L,n[11]=x*w+d*A+g*N+z*V,n[15]=x*C+d*O+g*P+z*k,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},applyToBufferAttribute:(n=new S,function(t){for(var i=0,s=t.count;i<s;i++)n.x=t.getX(i),n.y=t.getY(i),n.z=t.getZ(i),n.applyMatrix4(this),t.setXYZ(i,n.x,n.y,n.z);return t}),determinant:function(){var t=this.elements,i=t[0],s=t[4],e=t[8],n=t[12],r=t[1],o=t[5],h=t[9],a=t[13],u=t[2],c=t[6],l=t[10],y=t[14];return t[3]*(+n*h*c-e*a*c-n*o*l+s*a*l+e*o*y-s*h*y)+t[7]*(+i*h*y-i*a*l+n*r*l-e*r*y+e*a*u-n*h*u)+t[11]*(+i*a*c-i*o*y-n*r*c+s*r*y+n*o*u-s*a*u)+t[15]*(-e*o*u-i*h*c+i*o*l+e*r*c-s*r*l+s*h*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t,i){var s=this.elements,e=t.elements,n=e[0],r=e[1],o=e[2],h=e[3],a=e[4],u=e[5],c=e[6],l=e[7],y=e[8],p=e[9],f=e[10],v=e[11],m=e[12],x=e[13],d=e[14],g=e[15],z=p*d*l-x*f*l+x*c*v-u*d*v-p*c*g+u*f*g,M=m*f*l-y*d*l-m*c*v+a*d*v+y*c*g-a*f*g,_=y*x*l-m*p*l+m*u*v-a*x*v-y*u*g+a*p*g,w=m*p*c-y*x*c-m*u*f+a*x*f+y*u*d-a*p*d,C=n*z+r*M+o*_+h*w;if(0===C){var b="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===i)throw new Error(b);return console.warn(b),this.identity()}var S=1/C;return s[0]=z*S,s[1]=(x*f*h-p*d*h-x*o*v+r*d*v+p*o*g-r*f*g)*S,s[2]=(u*d*h-x*c*h+x*o*l-r*d*l-u*o*g+r*c*g)*S,s[3]=(p*c*h-u*f*h-p*o*l+r*f*l+u*o*v-r*c*v)*S,s[4]=M*S,s[5]=(y*d*h-m*f*h+m*o*v-n*d*v-y*o*g+n*f*g)*S,s[6]=(m*c*h-a*d*h-m*o*l+n*d*l+a*o*g-n*c*g)*S,s[7]=(a*f*h-y*c*h+y*o*l-n*f*l-a*o*v+n*c*v)*S,s[8]=_*S,s[9]=(m*p*h-y*x*h-m*r*v+n*x*v+y*r*g-n*p*g)*S,s[10]=(a*x*h-m*u*h+m*r*l-n*x*l-a*r*g+n*u*g)*S,s[11]=(y*u*h-a*p*h-y*r*l+n*p*l+a*r*v-n*u*v)*S,s[12]=w*S,s[13]=(y*x*o-m*p*o+m*r*f-n*x*f-y*r*d+n*p*d)*S,s[14]=(m*u*o-a*x*o-m*r*c+n*x*c+a*r*d-n*u*d)*S,s[15]=(a*p*o-y*u*o+y*r*c-n*p*c-a*r*f+n*u*f)*S,this},scale:function(t){var i=this.elements,s=t.x,e=t.y,n=t.z;return i[0]*=s,i[4]*=e,i[8]*=n,i[1]*=s,i[5]*=e,i[9]*=n,i[2]*=s,i[6]*=e,i[10]*=n,i[3]*=s,i[7]*=e,i[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],e=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,s,e))},makeTranslation:function(t,i,s){return this.set(1,0,0,t,0,1,0,i,0,0,1,s,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,i,-s,0,0,s,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,0,s,0,0,1,0,0,-s,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,-s,0,0,s,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var s=Math.cos(i),e=Math.sin(i),n=1-s,r=t.x,o=t.y,h=t.z,a=n*r,u=n*o;return this.set(a*r+s,a*o-e*h,a*h+e*o,0,a*o+e*h,u*o+s,u*h-e*r,0,a*h-e*o,u*h+e*r,n*h*h+s,0,0,0,0,1),this},makeScale:function(t,i,s){return this.set(t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1),this},makeShear:function(t,i,s){return this.set(1,i,s,0,t,1,s,0,t,i,1,0,0,0,0,1),this},compose:function(t,i,s){var e=this.elements,n=i._x,r=i._y,o=i._z,h=i._w,a=n+n,u=r+r,c=o+o,l=n*a,y=n*u,p=n*c,f=r*u,v=r*c,m=o*c,x=h*a,d=h*u,g=h*c,z=s.x,M=s.y,_=s.z;return e[0]=(1-(f+m))*z,e[1]=(y+g)*z,e[2]=(p-d)*z,e[3]=0,e[4]=(y-g)*M,e[5]=(1-(l+m))*M,e[6]=(v+x)*M,e[7]=0,e[8]=(p+d)*_,e[9]=(v-x)*_,e[10]=(1-(l+f))*_,e[11]=0,e[12]=t.x,e[13]=t.y,e[14]=t.z,e[15]=1,this},decompose:(c=new S,l=new C,function(t,i,s){var e=this.elements,n=c.set(e[0],e[1],e[2]).length(),r=c.set(e[4],e[5],e[6]).length(),o=c.set(e[8],e[9],e[10]).length();this.determinant()<0&&(n=-n),t.x=e[12],t.y=e[13],t.z=e[14],l.copy(this);var h=1/n,a=1/r,u=1/o;return l.elements[0]*=h,l.elements[1]*=h,l.elements[2]*=h,l.elements[4]*=a,l.elements[5]*=a,l.elements[6]*=a,l.elements[8]*=u,l.elements[9]*=u,l.elements[10]*=u,i.setFromRotationMatrix(l),s.x=n,s.y=r,s.z=o,this}),makePerspective:function(t,i,s,e,n,r){void 0===r&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,h=2*n/(i-t),a=2*n/(s-e),u=(i+t)/(i-t),c=(s+e)/(s-e),l=-(r+n)/(r-n),y=-2*r*n/(r-n);return o[0]=h,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=a,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=l,o[14]=y,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,i,s,e,n,r){var o=this.elements,h=1/(i-t),a=1/(s-e),u=1/(r-n),c=(i+t)*h,l=(s+e)*a,y=(r+n)*u;return o[0]=2*h,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*a,o[9]=0,o[13]=-l,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-y,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var i=this.elements,s=t.elements,e=0;e<16;e++)if(i[e]!==s[e])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var s=0;s<16;s++)this.elements[s]=t[s+i];return this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var s=this.elements;return t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=s[3],t[i+4]=s[4],t[i+5]=s[5],t[i+6]=s[6],t[i+7]=s[7],t[i+8]=s[8],t[i+9]=s[9],t[i+10]=s[10],t[i+11]=s[11],t[i+12]=s[12],t[i+13]=s[13],t[i+14]=s[14],t[i+15]=s[15],t}}),Object.assign(b,{slerp:function(t,i,s,e){return s.copy(t).slerp(i,e)},slerpFlat:function(t,i,s,e,n,r,o){var h=s[e+0],a=s[e+1],u=s[e+2],c=s[e+3],l=n[r+0],y=n[r+1],p=n[r+2],f=n[r+3];if(c!==f||h!==l||a!==y||u!==p){var v=1-o,m=h*l+a*y+u*p+c*f,x=0<=m?1:-1,d=1-m*m;if(d>Number.EPSILON){var g=Math.sqrt(d),z=Math.atan2(g,m*x);v=Math.sin(v*z)/g,o=Math.sin(o*z)/g}var M=o*x;if(h=h*v+l*M,a=a*v+y*M,u=u*v+p*M,c=c*v+f*M,v===1-o){var _=1/Math.sqrt(h*h+a*a+u*u+c*c);h*=_,a*=_,u*=_,c*=_}}t[i]=h,t[i+1]=a,t[i+2]=u,t[i+3]=c}}),Object.defineProperties(b.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(b.prototype,{set:function(t,i,s,e){return this._x=t,this._y=i,this._z=s,this._w=e,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var s=t._x,e=t._y,n=t._z,r=t.order,o=Math.cos,h=Math.sin,a=o(s/2),u=o(e/2),c=o(n/2),l=h(s/2),y=h(e/2),p=h(n/2);return"XYZ"===r?(this._x=l*u*c+a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c-l*y*p):"YXZ"===r?(this._x=l*u*c+a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c+l*y*p):"ZXY"===r?(this._x=l*u*c-a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c-l*y*p):"ZYX"===r?(this._x=l*u*c-a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c+l*y*p):"YZX"===r?(this._x=l*u*c+a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c-l*y*p):"XZY"===r&&(this._x=l*u*c-a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c+l*y*p),!1!==i&&this.onChangeCallback(),this},setFromAxisAngle:function(t,i){var s=i/2,e=Math.sin(s);return this._x=t.x*e,this._y=t.y*e,this._z=t.z*e,this._w=Math.cos(s),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var i,s=t.elements,e=s[0],n=s[4],r=s[8],o=s[1],h=s[5],a=s[9],u=s[2],c=s[6],l=s[10],y=e+h+l;return 0<y?(i=.5/Math.sqrt(y+1),this._w=.25/i,this._x=(c-a)*i,this._y=(r-u)*i,this._z=(o-n)*i):h<e&&l<e?(i=2*Math.sqrt(1+e-h-l),this._w=(c-a)/i,this._x=.25*i,this._y=(n+o)/i,this._z=(r+u)/i):l<h?(i=2*Math.sqrt(1+h-e-l),this._w=(r-u)/i,this._x=(n+o)/i,this._y=.25*i,this._z=(a+c)/i):(i=2*Math.sqrt(1+l-e-h),this._w=(o-n)/i,this._x=(r+u)/i,this._y=(a+c)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:(f=new S,function(t,i){return void 0===f&&(f=new S),(y=t.dot(i)+1)<1e-6?(y=0,Math.abs(t.x)>Math.abs(t.z)?f.set(-t.y,t.x,0):f.set(0,-t.z,t.y)):f.crossVectors(t,i),this._x=f.x,this._y=f.y,this._z=f.z,this._w=y,this.normalize()}),angleTo:function(t){return 2*Math.acos(Math.abs(w.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,i){var s=this.angleTo(t);if(0===s)return this;var e=Math.min(1,i/s);return this.slerp(t,e),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var s=t._x,e=t._y,n=t._z,r=t._w,o=i._x,h=i._y,a=i._z,u=i._w;return this._x=s*u+r*o+e*a-n*h,this._y=e*u+r*h+n*o-s*a,this._z=n*u+r*a+s*h-e*o,this._w=r*u-s*o-e*h-n*a,this.onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var s=this._x,e=this._y,n=this._z,r=this._w,o=r*t._w+s*t._x+e*t._y+n*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),1<=o)return this._w=r,this._x=s,this._y=e,this._z=n,this;var h=1-o*o;if(h<=Number.EPSILON){var a=1-i;return this._w=a*r+i*this._w,this._x=a*s+i*this._x,this._y=a*e+i*this._y,this._z=a*n+i*this._z,this.normalize()}var u=Math.sqrt(h),c=Math.atan2(u,o),l=Math.sin((1-i)*c)/u,y=Math.sin(i*c)/u;return this._w=r*l+this._w*y,this._x=s*l+this._x*y,this._y=e*l+this._y*y,this._z=n*l+this._z*y,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(S.prototype,{isVector3:!0,set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:(_=new b,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_.setFromEuler(t))}),applyAxisAngle:(M=new b,function(t,i){return this.applyQuaternion(M.setFromAxisAngle(t,i))}),applyMatrix3:function(t){var i=this.x,s=this.y,e=this.z,n=t.elements;return this.x=n[0]*i+n[3]*s+n[6]*e,this.y=n[1]*i+n[4]*s+n[7]*e,this.z=n[2]*i+n[5]*s+n[8]*e,this},applyMatrix4:function(t){var i=this.x,s=this.y,e=this.z,n=t.elements,r=1/(n[3]*i+n[7]*s+n[11]*e+n[15]);return this.x=(n[0]*i+n[4]*s+n[8]*e+n[12])*r,this.y=(n[1]*i+n[5]*s+n[9]*e+n[13])*r,this.z=(n[2]*i+n[6]*s+n[10]*e+n[14])*r,this},applyQuaternion:function(t){var i=this.x,s=this.y,e=this.z,n=t.x,r=t.y,o=t.z,h=t.w,a=h*i+r*e-o*s,u=h*s+o*i-n*e,c=h*e+n*s-r*i,l=-n*i-r*s-o*e;return this.x=a*h+l*-n+u*-o-c*-r,this.y=u*h+l*-r+c*-n-a*-o,this.z=c*h+l*-o+a*-r-u*-n,this},project:(z=new C,function(t){return z.multiplyMatrices(t.projectionMatrix,z.getInverse(t.matrixWorld)),this.applyMatrix4(z)}),unproject:(g=new C,function(t){return g.multiplyMatrices(t.matrixWorld,g.getInverse(t.projectionMatrix)),this.applyMatrix4(g)}),transformDirection:function(t){var i=this.x,s=this.y,e=this.z,n=t.elements;return this.x=n[0]*i+n[4]*s+n[8]*e,this.y=n[1]*i+n[5]*s+n[9]*e,this.z=n[2]*i+n[6]*s+n[10]*e,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:(x=new S,d=new S,function(t,i){return x.set(t,t,t),d.set(i,i,i),this.clamp(x,d)}),clampLength:function(t,i){var s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(i,s)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t)},cross:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)},crossVectors:function(t,i){var s=t.x,e=t.y,n=t.z,r=i.x,o=i.y,h=i.z;return this.x=e*h-n*o,this.y=n*r-s*h,this.z=s*o-e*r,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:(m=new S,function(t){return m.copy(this).projectOnVector(t),this.sub(m)}),reflect:(v=new S,function(t){return this.sub(v.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){var i=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(w.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y,e=this.z-t.z;return i*i+s*s+e*e},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var i=Math.sin(t.phi)*t.radius;return this.x=i*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=i*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),e=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=s,this.z=e,this},setFromMatrixColumn:function(t,i){return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromBufferAttribute:function(t,i,s){return void 0!==s&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}}),Object.assign(A.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){var s=this.getUtoTmapping(t);return this.getPoint(s,i)},getPoints:function(t){void 0===t&&(t=5);for(var i=[],s=0;s<=t;s++)i.push(this.getPoint(s/t));return i},getSpacedPoints:function(t){void 0===t&&(t=5);for(var i=[],s=0;s<=t;s++)i.push(this.getPointAt(s/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,s,e=[],n=this.getPoint(0),r=0;for(e.push(0),s=1;s<=t;s++)r+=(i=this.getPoint(s/t)).distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){var s,e=this.getLengths(),n=0,r=e.length;s=i||t*e[r-1];for(var o,h=0,a=r-1;h<=a;)if((o=e[n=Math.floor(h+(a-h)/2)]-s)<0)h=n+1;else{if(!(0<o)){a=n;break}a=n-1}if(e[n=a]===s)return n/(r-1);var u=e[n];return(n+(s-u)/(e[n+1]-u))/(r-1)},getTangent:function(t){var i=t-1e-4,s=t+1e-4;i<0&&(i=0),1<s&&(s=1);var e=this.getPoint(i);return this.getPoint(s).clone().sub(e).normalize()},getTangentAt:function(t){var i=this.getUtoTmapping(t);return this.getTangent(i)},computeFrenetFrames:function(t,i){var s,e,n,r=new S,o=[],h=[],a=[],u=new S,c=new C;for(s=0;s<=t;s++)e=s/t,o[s]=this.getTangentAt(e),o[s].normalize();h[0]=new S,a[0]=new S;var l=Number.MAX_VALUE,y=Math.abs(o[0].x),p=Math.abs(o[0].y),f=Math.abs(o[0].z);for(y<=l&&(l=y,r.set(1,0,0)),p<=l&&(l=p,r.set(0,1,0)),f<=l&&r.set(0,0,1),u.crossVectors(o[0],r).normalize(),h[0].crossVectors(o[0],u),a[0].crossVectors(o[0],h[0]),s=1;s<=t;s++)h[s]=h[s-1].clone(),a[s]=a[s-1].clone(),u.crossVectors(o[s-1],o[s]),u.length()>Number.EPSILON&&(u.normalize(),n=Math.acos(w.clamp(o[s-1].dot(o[s]),-1,1)),h[s].applyMatrix4(c.makeRotationAxis(u,n))),a[s].crossVectors(o[s],h[s]);if(!0===i)for(n=Math.acos(w.clamp(h[0].dot(h[t]),-1,1)),n/=t,0<o[0].dot(u.crossVectors(h[0],h[t]))&&(n=-n),s=1;s<=t;s++)h[s].applyMatrix4(c.makeRotationAxis(o[s],n*s)),a[s].crossVectors(o[s],h[s]);return{tangents:o,normals:h,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((O.prototype=Object.create(A.prototype)).constructor=O).prototype.isEllipseCurve=!0,O.prototype.getPoint=function(t,i){for(var s=i||new p,e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;n<0;)n+=e;for(;e<n;)n-=e;n<Number.EPSILON&&(n=r?0:e),!0!==this.aClockwise||r||(n===e?n=-e:n-=e);var o=this.aStartAngle+t*n,h=this.aX+this.xRadius*Math.cos(o),a=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),l=h-this.aX,y=a-this.aY;h=l*u-y*c+this.aX,a=l*c+y*u+this.aY}return s.set(h,a)},O.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},O.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},O.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((E.prototype=Object.create(O.prototype)).constructor=E).prototype.isArcCurve=!0;var N=new S,P=new R,T=new R,L=new R;function V(t,i,s,e){A.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=i||!1,this.curveType=s||"centripetal",this.tension=e||.5}function k(t,i,s,e,n){var r=.5*(e-i),o=.5*(n-s),h=t*t;return(2*s-2*e+r+o)*(t*h)+(-3*s+3*e-2*r-o)*h+r*t+s}function J(t,i,s,e){return(o=1-t)*o*i+2*(1-(r=t))*r*s+(n=t)*n*e;var n,r,o}function j(t,i,s,e,n){return(u=1-t)*u*u*i+3*(a=1-(h=t))*a*h*s+3*(1-(o=t))*o*o*e+(r=t)*r*r*n;var r,o,h,a,u}function q(t,i,s,e){A.call(this),this.type="CubicBezierCurve",this.v0=t||new p,this.v1=i||new p,this.v2=s||new p,this.v3=e||new p}function F(t,i,s,e){A.call(this),this.type="CubicBezierCurve3",this.v0=t||new S,this.v1=i||new S,this.v2=s||new S,this.v3=e||new S}function X(t,i){A.call(this),this.type="LineCurve",this.v1=t||new p,this.v2=i||new p}function Y(t,i){A.call(this),this.type="LineCurve3",this.v1=t||new S,this.v2=i||new S}function B(t,i,s){A.call(this),this.type="QuadraticBezierCurve",this.v0=t||new p,this.v1=i||new p,this.v2=s||new p}function D(t,i,s){A.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new S,this.v1=i||new S,this.v2=s||new S}function I(t){A.call(this),this.type="SplineCurve",this.points=t||[]}((V.prototype=Object.create(A.prototype)).constructor=V).prototype.isCatmullRomCurve3=!0,V.prototype.getPoint=function(t,i){var s,e,n,r,o=i||new S,h=this.points,a=h.length,u=(a-(this.closed?0:1))*t,c=Math.floor(u),l=u-c;if(this.closed?c+=0<c?0:(Math.floor(Math.abs(c)/a)+1)*a:0===l&&c===a-1&&(c=a-2,l=1),this.closed||0<c?s=h[(c-1)%a]:(N.subVectors(h[0],h[1]).add(h[0]),s=N),e=h[c%a],n=h[(c+1)%a],this.closed||c+2<a?r=h[(c+2)%a]:(N.subVectors(h[a-1],h[a-2]).add(h[a-1]),r=N),"centripetal"===this.curveType||"chordal"===this.curveType){var y="chordal"===this.curveType?.5:.25,p=Math.pow(s.distanceToSquared(e),y),f=Math.pow(e.distanceToSquared(n),y),v=Math.pow(n.distanceToSquared(r),y);f<1e-4&&(f=1),p<1e-4&&(p=f),v<1e-4&&(v=f),P.initNonuniformCatmullRom(s.x,e.x,n.x,r.x,p,f,v),T.initNonuniformCatmullRom(s.y,e.y,n.y,r.y,p,f,v),L.initNonuniformCatmullRom(s.z,e.z,n.z,r.z,p,f,v)}else"catmullrom"===this.curveType&&(P.initCatmullRom(s.x,e.x,n.x,r.x,this.tension),T.initCatmullRom(s.y,e.y,n.y,r.y,this.tension),L.initCatmullRom(s.z,e.z,n.z,r.z,this.tension));return o.set(P.calc(l),T.calc(l),L.calc(l)),o},V.prototype.copy=function(t){A.prototype.copy.call(this,t),this.points=[];for(var i=0,s=t.points.length;i<s;i++){var e=t.points[i];this.points.push(e.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},V.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);t.points=[];for(var i=0,s=this.points.length;i<s;i++){var e=this.points[i];t.points.push(e.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},V.prototype.fromJSON=function(t){A.prototype.fromJSON.call(this,t),this.points=[];for(var i=0,s=t.points.length;i<s;i++){var e=t.points[i];this.points.push((new S).fromArray(e))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((q.prototype=Object.create(A.prototype)).constructor=q).prototype.isCubicBezierCurve=!0,q.prototype.getPoint=function(t,i){var s=i||new p,e=this.v0,n=this.v1,r=this.v2,o=this.v3;return s.set(j(t,e.x,n.x,r.x,o.x),j(t,e.y,n.y,r.y,o.y)),s},q.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},q.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},q.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((F.prototype=Object.create(A.prototype)).constructor=F).prototype.isCubicBezierCurve3=!0,F.prototype.getPoint=function(t,i){var s=i||new S,e=this.v0,n=this.v1,r=this.v2,o=this.v3;return s.set(j(t,e.x,n.x,r.x,o.x),j(t,e.y,n.y,r.y,o.y),j(t,e.z,n.z,r.z,o.z)),s},F.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},F.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},F.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},((X.prototype=Object.create(A.prototype)).constructor=X).prototype.isLineCurve=!0,X.prototype.getPoint=function(t,i){var s=i||new p;return 1===t?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(t).add(this.v1)),s},X.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},X.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},X.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},X.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},X.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((Y.prototype=Object.create(A.prototype)).constructor=Y).prototype.isLineCurve3=!0,Y.prototype.getPoint=function(t,i){var s=i||new S;return 1===t?s.copy(this.v2):(s.copy(this.v2).sub(this.v1),s.multiplyScalar(t).add(this.v1)),s},Y.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},Y.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Y.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Y.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((B.prototype=Object.create(A.prototype)).constructor=B).prototype.isQuadraticBezierCurve=!0,B.prototype.getPoint=function(t,i){var s=i||new p,e=this.v0,n=this.v1,r=this.v2;return s.set(J(t,e.x,n.x,r.x),J(t,e.y,n.y,r.y)),s},B.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},B.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},B.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((D.prototype=Object.create(A.prototype)).constructor=D).prototype.isQuadraticBezierCurve3=!0,D.prototype.getPoint=function(t,i){var s=i||new S,e=this.v0,n=this.v1,r=this.v2;return s.set(J(t,e.x,n.x,r.x),J(t,e.y,n.y,r.y),J(t,e.z,n.z,r.z)),s},D.prototype.copy=function(t){return A.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},D.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},D.prototype.fromJSON=function(t){return A.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},((I.prototype=Object.create(A.prototype)).constructor=I).prototype.isSplineCurve=!0,I.prototype.getPoint=function(t,i){var s=i||new p,e=this.points,n=(e.length-1)*t,r=Math.floor(n),o=n-r,h=e[0===r?r:r-1],a=e[r],u=e[r>e.length-2?e.length-1:r+1],c=e[r>e.length-3?e.length-1:r+2];return s.set(k(o,h.x,a.x,u.x,c.x),k(o,h.y,a.y,u.y,c.y)),s},I.prototype.copy=function(t){A.prototype.copy.call(this,t),this.points=[];for(var i=0,s=t.points.length;i<s;i++){var e=t.points[i];this.points.push(e.clone())}return this},I.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);t.points=[];for(var i=0,s=this.points.length;i<s;i++){var e=this.points[i];t.points.push(e.toArray())}return t},I.prototype.fromJSON=function(t){A.prototype.fromJSON.call(this,t),this.points=[];for(var i=0,s=t.points.length;i<s;i++){var e=t.points[i];this.points.push((new p).fromArray(e))}return this};var U=Object.freeze({ArcCurve:E,CatmullRomCurve3:V,CubicBezierCurve:q,CubicBezierCurve3:F,EllipseCurve:O,LineCurve:X,LineCurve3:Y,QuadraticBezierCurve:B,QuadraticBezierCurve3:D,SplineCurve:I});function Q(){A.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Q.prototype=Object.assign(Object.create(A.prototype),{constructor:Q,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new X(i,t))},getPoint:function(t){for(var i=t*this.getLength(),s=this.getCurveLengths(),e=0;e<s.length;){if(s[e]>=i){var n=s[e]-i,r=this.curves[e],o=r.getLength(),h=0===o?0:1-n/o;return r.getPointAt(h)}e++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],i=0,s=0,e=this.curves.length;s<e;s++)i+=this.curves[s].getLength(),t.push(i);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var i=[],s=0;s<=t;s++)i.push(this.getPoint(s/t));return this.autoClose&&i.push(i[0]),i},getPoints:function(t){t=t||12;for(var i,s=[],e=0,n=this.curves;e<n.length;e++)for(var r=n[e],o=r&&r.isEllipseCurve?2*t:r&&(r.isLineCurve||r.isLineCurve3)?1:r&&r.isSplineCurve?t*r.points.length:t,h=r.getPoints(o),a=0;a<h.length;a++){var u=h[a];i&&i.equals(u)||(s.push(u),i=u)}return this.autoClose&&1<s.length&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s},copy:function(t){A.prototype.copy.call(this,t),this.curves=[];for(var i=0,s=t.curves.length;i<s;i++){var e=t.curves[i];this.curves.push(e.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=A.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var i=0,s=this.curves.length;i<s;i++){var e=this.curves[i];t.curves.push(e.toJSON())}return t},fromJSON:function(t){A.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var i=0,s=t.curves.length;i<s;i++){var e=t.curves[i];this.curves.push((new U[e.type]).fromJSON(e))}return this}}),t.Vector2=p,t.CurvePath=Q,t.ArcCurve=E,t.CatmullRomCurve3=V,t.CubicBezierCurve=q,t.CubicBezierCurve3=F,t.EllipseCurve=O,t.LineCurve=X,t.LineCurve3=Y,t.QuadraticBezierCurve=B,t.QuadraticBezierCurve3=D,t.SplineCurve=I,Object.defineProperty(t,"__esModule",{value:!0})});
